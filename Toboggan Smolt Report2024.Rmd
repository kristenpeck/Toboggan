---
title: "Toboggan Creek Coho Smolt Program 2024"
author: "Annie Kim and Kristen Peck, DFO North Coast Stock Assessment Branch"
date: "`r format(Sys.time(), '%Y-%m-%d')`"
output: 
  word_document:
    toc: yes
    toc_depth: 3

---
\newpage

# Abstract

# Acknowledgements

# Introduction
Toboggan Creek, situated near Smithers, British Columbia, is a glacial tributary to the Bulkley River that flows into the Skeena River. This system sustains a coho salmon *(Oncorhynchus kisutch)* population that has been augmented by a hatchery since 1984. Since its inception, the Toboggan Creek Salmon and Steelhead Enhancement Society (TCSSES) has overseen the hatchery operations and conducted most of the stock assessment activities tied to the program. The Toboggan Creek program is an indicator for North Coast coho populations, providing vital trend information about smolt production, harvest rates, marine survival, and annual escapement.

Coded wire tags (CWT) have been an essential tool for exploitation rate assessment data for Toboggan coho (Middle Skeena Conservation Unit) and has offered the longest-standing full indicator data for northern British Columbia. Since 1988, the full indicator program has been operational and crucial for assessing stock status (DFO NC StAD, 2022). An advantage of using CWTs is the ability to draw information on survival and/or abundance of a specific stock from highly mixed-stock fisheries (PSC NBTC, 2002). These models are particularly strong in predicting marine survival for tagged hatchery smolts. However, whether the survival and exploitation of hatchery and natural origin coho is the same is an assumption that has been recently called under question (Chicatun, 2024).

The Toboggan Creek smolt project, which began in 1995 by DFO and delivered by SKR Consultants, was designed to collect data on the number and age distribution of coho smolts migrating from the creek. In this context, “wild” coho refers to those of natural origin, as hatchery-bred adults are allowed to spawn with wild individuals in the creek. A fyke trap was initially used then trapping evolved to using rotary screw traps (RSTs) in 1998 to reduce stress and mortalities on the salmon. In 1999, CWT tags were used on the wild smolts to better estimate the wild population. In 2000, a wolf type weir (Wolf, 1951) was constructed upstream of the Toboggan Creek hatchery to allow greater catch of coho and upstream passage of steelhead *(O. mykiss)*, and an inclined plane trap (IPT) was installed downstream of the hatchery (SKR Consultants, 2001).

Following a temporary pause, the project resumed by DFO in 2020, operated by the Toboggan Creek Salmon and Steelhead Society. Marked hatchery smolts volitionally out-migrated from the hatchery ponds  and was used as the “marked” component of the mark-recapture program estimating the smolt population size. While the Toboggan program serves as an indicator for wild fish populations, it had only marked hatchery coho, operating under the assumption that hatchery and wild-origin smolts follow similar migration routes and distributions. However, data from 2020 to 2023 suggests that survival rates may differ between wild and hatchery-origin coho, with environmental factors, management practices, and biological characteristics potentially influencing survival outcomes (Chicatun, 2024).

The absence of CWT hatchery fish releases in the spring of 2024, due to a disease outbreak at the hatchery, created challenges for determining exploitation rates for that year class. However, this setback presented a valuable opportunity to focus efforts on a wild-marking initiative. Therefore, DFO Stock Assessment ran a wild smolt trapping program in spring 2024 to bridge the gap of this missing year.     

## Objectives

**1.	Estimate the wild smolt population size out-migrating from Toboggan Creek using mark-recapture.**

**2.	Characterize size and age composition of the wild smolt outmigration from Toboggan Creek.**

**3.	Apply a large number of marks (adipose clip and coded-wire tag) to assess marine exploitation.**

\newpage

# Methods

The Toboggan Smolt program required intensive labour, especially during peak migration, high water and debris events. Rotary screw traps are sampling devices designed to capture downstream migrating juvenile fish. They are large, cylindrical traps that float on pontoons and can be positioned and set overnight to funnel out-migrating smolts into a holding chamber. Continuous rotation was crucial for trapping success, and if debris obstructed this movement it would cause a full night of trapping to be lost because the fish could swim out of the trap box. Regular trap check-ups included inspections of the cable system, connections, and pulleys to ensure they were in good condition and securely fastened. 
Rotary screw traps were prone to debris accumulation in the live boxes from leaves, logs, and branches, and could lead to high mortality rates or escape of juvenile fish if left unchecked. Therefore, early checks and working in split shifts was required. The programs ran five days per week from Sunday evening to Friday during the start and end of the migration period when fewer smolts were intercepted. During the peak migration, shifts ran seven days per week from Monday to Sunday. The shifts were split into two per day: a morning shift beginning at 5 am and ending once all the fish from the two traps were processed, and an evening shift at 8 pm for setting the traps. Traps were set overnight only because this was the time when the majority of the smolts out-migrated (data on file, DFO Smithers). On most days, three crew members were needed for daily operations.

During peak migration and high water events, the number of visits were dependent on the conditions of weather, forecast, and timing. Smolt migration timing in 2024 was similar to previous years where fish migration intensity increased after the second week of May and peaked from the end of May to mid-June.

Two sites were selected for the operation of this program, both accessed through private land:

•	Red Barn: Located 2.5 km downstream of the hatchery. A 4-ft diameter RST was installed at this site. 

•	Adult Fence: The adult fence site was located 4.5 km downstream of the hatchery. Outside of the adult enumeration season in late summer and fall only a wooden sill with no adult fish migration barrier exists at this location.  A 6-ft diameter RST was installed directly upstream of this structure and downstream of a private bridge. This was the same location as used for the previous years of smolt trapping but a larger diameter trap was installed to maximize capture rates.

## Environmental data

To investigate the relationship between environmental variables and coho smolt outmigration, we recorded discharge and temperature data at each trap check. Discharge data was obtained from the Water Survey of Canada’s real-time hydrometric station on Simpson Creek at the Mouth (station 08EE012; Environment Canada 2025), which served as a proxy for Toboggan Creek in the absence of a direct gauge. This substitution was deemed appropriate through DFO staff observation of flow patterns during field visits. Water temperatures and levels were taken by DFO technicians at the start of each site visit for both the Red Barn and Fence sites.

## Biosampling and CWT Tagging Procedure 

Detailed methods are found in Chicatun and Peck (2024), but relevant details are included below. While operating the trap, the goal was to minimize fish mortality and protect infrastructure. To meet the minimum target of 7000 CWT-marked smolts, both sites carried out adipose clipping and coded-wire tag marking with standard 1.1 mm tags with several codes. Additionally, a weekly-stratified clip was applied to smolts at the barn (upstream) trap to estimate weekly outmigration, alternating the upper and lower caudal clip each week. Recaptured fish at the downstream trap were inspected for the caudal clip. Biosampling of up to 25 smolts measured at each location per day, including measurements of fork length, weight, and collection of age structures, was conducted at both sites. 

The first 25 juvenile coho (excluding young-of-year fry) were measured for fork length to the nearest millimeter, and weights to the nearest 0.1 g. Scales were sampled starting at a fork length of 60 mm, with a target of 5-10 fish sampled for each 5 mm fork length interval. Any exceptionally large or small fish (down to 60 mm) was sampled for scales. Scales were sent to DFO’s Sclerochronology Lab at the end of the season for age determination and following the juvenile age sampling procedure (MacLellan 2004).
All fish >=70 mm were adipose clipped and tagged. Fish <70 mm were kept in a bucket and released. This size cut off for coded-wire tagging was based on the mark-recapture protocol from previous years of smolt sampling at this location. At  the Red Barn site, the caudal clip was applied according to the weekly stratification starting on Mondays (Top or Bottom). Fish were sorted based on size and coded wire tagged with the respective head mold size: small fish (70-85 mm): 65/lb head mold, big fish (86-115 mm): 45/lb, and bigger and biggest fish (116-190 mm or >190 mm): 15/lb head mold. Whenever there was a new tagger or tagging machine used, and particularly at the beginning of the season, a small number of fish were tagged and culled/sacrificed in order to check for correct tag placement. 

Tricaine methanesulfonate (TMS or MS222) was used to sedate the fish. A 5-gallon bucket and medium-sized dip nets were used to transport the fish from the RST holding box to the biosampling area. Battery-operated bubblers with diffusion stones were placed in the buckets to provide aeration for the waiting fish. A V-detector (Northwest Marine Technologies) was used to check for CWT tag retention and tallied by tag code. 

After the first 25 coho, the remaining coho were sorted using a fish viewer or by eye into the size categories for tagging. Every fish tagged was immediately checked for retention using the V-detector and placed in the recovery bucket. Once all the fish were tagged and recovered from the anesthetic, they were released in a calm eddy downstream. Any non-target fish were identified and, if time permitted, measured for length and weight.  

Unexpectedly, a small number of adipose clipped hatchery coho  from previous years were caught and identified by their healed-over adipose-clip, checked for CWT retention, measured and recorded,  and sacrificed to check the tag code. Hatchery fish were frozen in Ziplock bags, and later dissected by local staff for their CWTs. A dissecting microscope was used to read the CWTs and recorded.

## Overnight Retention Checks 

On Mondays and Tuesdays, up to 50 tagged fish at each site were placed in a holding pen to check for overnight coded wire tag retention. This retention rate was then applied to the fish tagged during the entire week, so consistency in terms of tagger, methodology, etc., were maintained for the week. Any fish that did not retain their tags were re-tagged. Any overnight mortalities were checked for along with possible causes for death and tag placement. The fish were then released in a calm location downstream.

## Data Analysis:

Data was compiled daily and entered into Microsoft Excel spreadsheets. Analysis focused on summarizing counts by species, site, size, correctly estimating CWT releases by tag code and estimating the out-migrating smolt population using mark-recapture. Environmental variables such as stream discharge and temperature were plotted to assess trends and identify potential associations with migration activity.

An age-length key was created by summarizing the relationship between age and fork length from the subsample of scale-sampled fish, which was then used to estimate age distribution across the remaining unaged fish. A correction for growth over the season was applied . To assess the relationship between weight and length, a log-log linear regression model was applied for comparison to other years and streams. Fulton’s Condition Factor (K) was calculated to assess body condition, using the formula:  K = W/L3 x 105, where W is weight in grams and L is fork length in mm. 
The retention rate of CWTs of the subsample of fish held over at each site on Monday and Turesday nights were averaged and applied to fish tagged the entire week. From the subsample, a small number of fish without a CWT were retagged, and these fish were added back to the total tags released after retention rates were applied for the week. 

One of the assumptions of mark-recapture models is the assumption of equal probability of release and recapture, which is likely violated in an outmigrating smolt population where smolts move directionally out of the system throughout the spring (Schwarz and Taylor 1998). Therefore a weekly stratified mark-recapture estimator was used to calculate the outmigrating smolt population (>70 mm) at arrival to the upstream trap using SPAS (Schwarz 2025). A simple Lincoln-Petersen estimator (i.e. fully pooled strata) was compared to a fully stratified estimator (i.e. all weekly strata kept as-is) and an automatic logical pooling of strata (i.e. strata pooled where catchability was similar) estimator using AICc (Burnham and Anderson 2002).

Otherwise, all data manipulation and visualization were conducted using R (v 4.4.2; R Core Team 2025) and packages tidyverse, readr, ggplot2, dplyr, knitr, kableExtra, scales, tidyr, flextable, FSA, magrittr, dplyr, and nnet. 

\newpage

# Results

```{r setup, include=FALSE}
knitr::opts_chunk$set(
    echo = FALSE,
  warning = FALSE,
  message = FALSE,
  fig.width = 6.5,    
  fig.height = 4.5,   
  out.width = "120%" 
)
```

```{r load-libraries, include=FALSE}
library(readr)
library(ggplot2)
library(dplyr)
library(knitr)
library(tidyverse)
library(kableExtra)
library(scales)
library(tidyr)
library(flextable)
library(FSA)
library(magrittr)
library(dplyr)
library(nnet)
library(readxl)
```

```{r load-data, include=FALSE}
file_path <- "toboggan_smolt_dataentry_FINAL 2024-copy19-Jan-2026.xlsx"
df_fish <- read_excel(file_path, sheet = "individualfish")

source("Smolt.R") # KP's scripts
source("Environmental.R")
```

## Environmental Conditions

The season began on 1 May with only five nights of trapping per week, then switched to seven nights per week as of the trap set on the evening of May 19, 2024 and back to five nights on 14 June. Fish catches were only occasionally impacted by environmental conditions; during periods of very low or very high water, the trap experienced periods of partial or full inoperability due to debris or flow levels (**Figure 1**). These events led to intermittent gaps or reductions in trap efficiency, especially on May 21, June 1 8 and 19. A total of 2 missed trap days/nights were lost because of high flows or debris, or about 3.64% of the total trapping days/nights.

```{r Figure 1 flow, fig.cap="Figure 1. Total daily fish catch at both traps compared to daily total discharge (in cubic meters per second or CMS) measured by the Hydrologic Station at Simpson Creek at the Mouth (08EE012; Environment Canada 2025). The Simpson Creek station was used as a surrogate for Toboggan Creek which did not have a station with discharge levels. The two creeks had similar patterns of water levels based on DFO staff observations and readings (data on file, DFO Smithers)."}

plot.daily.co.smolt

```

Water temperatures increased throughout the season at a rate of 0.06 degrees per day (p<0.001), and were generally cooler in the mornings at the trap pull and warmer in the evenings at trap set (**Figure 2**). The fence site appeared to be consistently cooler compared to the barn site but the difference was not significant (p = 0.18).

```{r Figure 2 temps, fig.cap="Figure 2. Water temperature was measured at the start of each site visit for both the barn (pink) and fence (teal) sites. The “pull” points in (circles) show temperatures taken when the traps were checked (usually in the morning when fish were collected for processing). The “set” points (triangles) show temperatures measured when the traps were reset in the evenings."}

plot.water.temp24

```

## Trap Catch

A  total of 18,615 coho smolts were caught throughout the season, and 20 of these were suspected to be hatchery releases from the previous spring based on their healed-over adipose fins, lack of a secondary mark and length (**Table 1**). There were more coho (wild) caught at the fence site than the barn site with a total count of 12,865  fish and 5,727 fish, respectively. The hatchery fish were sacrificed to retrieve the codes on their CWTs and all but 3 of these fish were aged with scale samples. Of these fish, 12 had coded-wire tags retained and 10 were readable as 2023 hatchery releases from the 2021 brood year. The remainder were aged as 3 year olds and assumed to be hatchery releases from the previous year based on their similar size, healed adipose scar and lack of a secondary mark. The average fork length of the hatchery coho was 122.89 mm (+/- 9.88 SD) and the average weight was 19.74 g (+/- 4.14 SD). Steelhead or rainbow trout *(O. mykiss)* were the most prevalent juvenile bycatch and only a small number of other species were observed (**Table 1**). Adult bycatch was released without counting. 

```{r Table 1 fish count, fig.cap= "Table 1. Total juvenile fish count for each species.", include=T}
df_fish <- df_fish %>%
  mutate(
    count = as.numeric(count),
    date = as.Date(date, tryFormats = c("%Y-%m-%d", "%m/%d/%Y")),
    mort = tolower(ifelse(is.na(mort), "no", mort)),
    sacrifice = tolower(ifelse(is.na(sacrifice), "no", sacrifice)),
    species = recode(species,
      "co-w" = "Coho (wild)",
      "st/rb" = "Steelhead or Rainbow trout",
      "co-a" = "Coho (hatchery)",
      "bt/dv" = "Bull trout or Dolly varden",
      "ct" = "Cutthroat",
      "mw" = "Mountain whitefish",
      "ch" = "Chinook",
      "pk" = "Pink"
    )
  )

summary_table <- df_fish %>%
  filter(!is.na(species) & species != "co-f") %>%
  group_by(species) %>%
  summarise(`Total Count` = sum(count, na.rm = TRUE), .groups = "drop") %>%
  rename(Species = species) %>%
  mutate(Species = factor(Species, 
                          levels = c("Coho (wild)", "Coho (hatchery)", 
                                     "Steelhead or Rainbow trout", 
                                     "Bull trout or Dolly varden", 
                                     "Cutthroat", 
                                     "Mountain whitefish", 
                                     "Chinook", 
                                     "Pink"))) %>%
  arrange(Species)

summary_table %>%
  kable(caption = "Table 1. Total count of fish for each juvenile species.", format = "pandoc",full_width=FALSE, latex_options = "HOLD_position",bootstrap_options = c("striped", "hover")) 
  # kable_styling(full_width = TRUE, position = "center", bootstrap_options = c("striped", "hover"))
```

*Note that these were hatchery fish released in previous years, identified by their healed-over adipose clip scar in the field and confirmed with dissected tag codes.*

## Smolt Migration Timing

The peak for wild coho smolt outmigration occurred between the last week of May and the first two weeks of June (**Figure 3**). The date with the greatest count of coho (wild) was June 4, 2024, with a total count of 1,681 fish between the two sites. The date with the lowest count of coho (wild) was June 24, 2024, with a total count of 17 fish.

```{r Figure 3 timing, fig.cap="Figure 3. Daily count of coho (wild) at each site (barn vs fence). The barn site was upstream with a 4 ft-diameter RST and fence site was downstream with a 6 ft-diameter RST."}
daily_counts_cow <- df_fish %>%
  filter(species == "Coho (wild)", site %in% c("barn", "fence")) %>%
  group_by(date, site) %>%
  summarise(daily_count = sum(count, na.rm = TRUE), .groups = "drop") %>%
  arrange(date)

if (nrow(daily_counts_cow) == 0) stop("Error: No data available for CO-W at Barn and Fence sites.")

# Plot daily counts for CO-W
ggplot(daily_counts_cow, aes(x = date, y = daily_count, color = site, linetype = site)) +
  geom_line(linewidth = 1) +
  geom_point(size = 1.5) +
  scale_x_date(
    breaks = seq(min(daily_counts_cow$date, na.rm = TRUE), max(daily_counts_cow$date, na.rm = TRUE), by = "1 week"),
    date_labels = "%d-%b"
  ) +
  labs(
    x = "Date",
    y = "Daily Count"
  ) +
  theme_bw() +
   theme(
    axis.text.x = element_text(angle = 45, hjust = 1)
  )
```

## Mortalities

While great care and precaution was taken to ensure as little harm to fish as possible, a relatively small percentage of mortalities did occur, both accidentally and intentionally (**Table 2**). Accidental mortalities could have occurred through stress from the traps, anesthesia, handling, or a combination of all. Intentional mortalities occurred for two reasons; first, a small sample (0.07%) of wild coho were sacrificed to check for correct CWT placement to determine the correct head mold size to use for tagging. Second, all hatchery coho were culled in order to retrieve their CWT codes. 


```{r Table 2 mortalities}
mortality_summary <- df_fish %>%
  filter(species != "co-f") %>% 
  group_by(species) %>%
  summarise(
    `Total Fish per Species` = sum(count, na.rm = TRUE),  
    `Total Accidental` = sum(ifelse(mort == "yes", count, 0), na.rm = TRUE),
    `Total Sacrifice` = sum(ifelse(sacrifice == "yes", count, 0), na.rm = TRUE),
    .groups = "drop"
  ) %>%
  mutate(
    `% Accidental` = round((`Total Accidental` / `Total Fish per Species`) * 100, 2),
    `% Sacrifice` = round((`Total Sacrifice` / `Total Fish per Species`) * 100, 2),
    `% Accidental` = paste0(replace_na(`% Accidental`, 0), "%"),
    `% Sacrifice` = paste0(replace_na(`% Sacrifice`, 0), "%")
  ) %>%
  filter(`Total Accidental` > 0 | `Total Sacrifice` > 0)  # Remove species with zero mortality

# Add Coho (hatchery) data (all sacrificed)
coho_hatchery_data <- df_fish %>%
  filter(species == "Coho (hatchery)") %>%
  summarise(
    species = "Coho (hatchery)",
    `Total Fish per Species` = sum(count, na.rm = TRUE),
    `Total Accidental` = 0,
    `Total Sacrifice` = sum(count, na.rm = TRUE),
    `% Accidental` = "0%",
    `% Sacrifice` = "100%",
    .groups = "drop"
  )

# Bind Coho (hatchery) data and update column names and row order
mortality_summary <- bind_rows(mortality_summary, coho_hatchery_data) %>%
  rename(Species = species) %>%
  arrange(match(Species, c("Coho (wild)", "Coho (hatchery)")), Species)

# Display the table
mortality_summary %>%
  kable(format = "pandoc", booktabs = TRUE, align = c("l", "r", "r", "r", "r", "r"),
        col.names = c("Species", 
                      "Total Fish", 
                      "Total Accidental", 
                      "Total Sacrifice", 
                      "% Accidental", 
                      "% Sacrifice"),
        caption = "Table 2. Accidental and sacrificed mortalities by species or wild/hatchery status. Percentages are out of the total of each captured species."
)
      
```

## Age and Size

**Figure 4** illustrates the log-log transformed weight-length relationship for measured wild coho. The linear trend describes the growth pattern in coho where weight increases at an exponential rate relative to length. Fulton’s Condition Factor (K) was calculated and the mean condition factor was 1.08 (+/- 0.12 SD), with values ranging from 0.50 to 2.87.   

```{r Figure 4, fig.cap="Figure 4. Log-log weight-length individual values and relationship for coho smolts. The scatterplot presents individual observations of fork length (mm) and weight (g), with a fitted regression line overlaid in blue and the regression described in the formula within the plot.", results = 'hide'}
df_fish_coho <- df_fish %>% 
   filter(
    species %in% c("Coho (wild)", "Coho (hatchery)"),  # Keep only co-w and co-a
    !is.na(fork_length_mm), 
    !is.na(weight_g), 
    weight_g > 0, 
    fork_length_mm > 0
  )

length_weight_model <- lm(log10(weight_g) ~ log10(fork_length_mm), data = df_fish_coho)
summary(length_weight_model)

eq.log10FLwt <- paste0(expression(log[10](Weight)),"=",round(coef(length_weight_model)[1],2),
                       "+",round(coef(length_weight_model)[2],2),"*",expression(log[10](Length)))


ggplot(df_fish_coho, aes(x = fork_length_mm, y = weight_g)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", col = "blue") +
  scale_x_log10() +  # Apply log scale to x-axis
  scale_y_log10() +  # Apply log scale to y-axis for consistency
  # annotate("text",label= eq.log10FLwt,
  #          x = max(df_fish_coho$fork_length_mm) * 0.9,
  #          y = min(df_fish_coho$weight_g) * 3)
  labs(
    x = expression(log[10](Fork~Length~(mm))),
    y = expression(log[10](Weight~(g)))
  ) +
  annotate("text", 
           x = max(df_fish_coho$fork_length_mm) * 0.9,  # Leave in original scale
           y = min(df_fish_coho$weight_g) * 3,  # Leave in original scale
           label = eq.log10FLwt, 
           size = 3.5,  # Make text smaller
           hjust = 1, 
           fontface = "italic") +
  theme_bw() +
  theme(plot.title = element_text(hjust = 0.5))

#ggsave("co_w_size_histogram.png", width = 7, height = 5)
```

A large component of the population sampled appeared to be two year olds (brood year 2022) but a large proportion were also three years old and even four (brood years 2021 and 2020, respectively; **Figure 5**). Fish were sampled throughout the season and substantial growth occurred within each age.  Sampling was unevenly concentrated towards the beginning of the season and most late samples were unrepresented, so no age-length keys were created. The largest fish seemed to outmigrate during the middle of the trapping season, while smaller fish had a more steady outmigration throughout the season.

```{r Figure 5, echo=FALSE, fig.cap="Figure 5. Subsample of aged wild coho plotted with fork length measurements throughout the season. Grey dots are unaged fish whose fork lengths were measured but no age sample taken. Lines for each age are linear regressions with standard error shading. Only fish greater than 60 mm were measured. Age is represented by the Gilbert-Rich (GR) age designation system."}

plot.fork.length.age

```

## Coded-Wire Tagging

Each wild coho smolt was sorted into size categories so they could be CWT tagged with the correct head mold size. Coho between 86-115 mm were most abundant with a total of 13,588 fish (**Figure  6**). Coho between 70-85 mm and 116-190 mm had similar counts with a total of 1,161 and 1,145, respectively. Coho between 60-69 mm and >190 mm was least abundant with totals of 206 and 1 fish, respectively.

```{r Figure 6, fig.cap="Figure 6. Total count of coho (wild) by size category, which matched the head mold used for coded-wire tagging."}
size_order <- c("little", "small", "big", "bigger", "biggest")
co_w_size_counts <- df_fish %>%
  filter(species == "Coho (wild)", !is.na(size_cwt)) %>%
  group_by(size_cwt) %>%
  summarise(total_count = sum(count, na.rm = TRUE), .groups = "drop") %>%
  mutate(size_cwt = factor(size_cwt, levels = size_order))

if (nrow(co_w_size_counts) == 0) stop("Error: No size data for Coho (wild) available.")

ggplot(co_w_size_counts, aes(size_cwt, total_count, fill = size_cwt)) +
  geom_bar(stat = "identity", color = "black") +
  labs(
    x = "Size Category", 
    y = "Total Coded-Wire Tags Applied",
    # fill = "Size Category"  # Change legend title # KP: legend just repeated x axis, removed
  ) +
  scale_x_discrete(
    labels = c(
      "little" = "60-69 mm",
      "small" = "70-85 mm",
      "big" = "86-115 mm",
      "bigger" = "116-190 mm",
      "biggest" = ">190 mm"
    )
  ) +
  scale_fill_manual(
    values = c(
      "little" = "lightblue", 
      "small" = "blue", 
      "big" = "darkblue", 
      "bigger" = "purple", 
      "biggest" = "red"
    ),
    labels = c(
      "little" = "60-69 mm",
      "small" = "70-85 mm",
      "big" = "86-115 mm",
      "bigger" = "116-190 mm",
      "biggest" = ">190 mm"
    )
  ) +
  theme_bw() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "none"
  ) +
  scale_y_continuous(breaks = pretty_breaks(n = 6))
#ggsave("co_w_size_histogram.png", width = 7, height = 5)
```

24-hour retention rates for the CWTs were generally quite high and the average retention for the two representative days at the start of the week was applied to the rest of the injected fish that week (**Table 3**). Any shed tags from the subsample were also re-tagged and re-added to the total releases. A total of 15,420 coho were estimated to be released to the ocean with a coded-wire tag. Size classes were generally kept consistent within the coded-wire tag code, so some anecdotal information about the size of fish in the ocean catches can be drawn from the tag size.

```{r Table 3 CWT tags}

kable(CWT.tag.summary2024 %>% select(-est.retained),
        col.names = c("Tag Code","#Inj","Est.Lost","#Re-tagged","Total Releases","Mean FL(mm)","SD FL(mm)","Mean Wt(g)","SD Wt(g)"),
        caption = "Table 3. Summary of the number of injected smolts for each coded-wire tag. Coho were generally sorted by size for coded-wire tagging. Estimated retention was based on a subsample of tagged smolts each week held for 24 hours after initial tagging.",
      format = "pandoc", align = "c") 
  #
```


## Mark-Recapture

The weekly stratification was only using two marks: upper and lower caudal fin clips, alternated each Monday. This assumed that all fish that arrived at the upper trap passed through the lower trap area within one week. Based on the first tags released from the barn site each week, the first fish appeared to arrive at the fence trap by the next day and persist in diminishing numbers throughout the following week (**Figure 7**). A small number of marks were not recognizable as top or bottom clips (n=`r sum(ifelse(mark.recaps24fence$name %in% "none",mark.recaps24fence$value,0))`) and were removed from the mark-recapture analysis. While it appears that perhaps not all fish have moved past the downstream trap in one week, the majority of them did.

```{r Figure 7 timing, fig.cap="Comparison of daily mark sequence applied at the barn (the upstream trap) in the bubble plot below the x-axis scaled by number of applied tags. The bar chart shows the daily number of recaptures at the fence site (downstream) with the different caudal clips. None meant that the caudal clip was not recognizable, and this was the case for a small number of recaptures throughout the season. These fish were removed from the mark-recapture analysis."}

plot.mark.timing24bubble

```

Marks by week and their recaptures in that week and the following are summarize in **Table 4** following Schwarz (2025). 

```{r Table 4 MR strata}
kable(x,
      caption = "Table 4. Summary of weekly releases and recoveries by strata following Schwarz (2025). Row and column names are isoweeks, with rows (s) as the release week from the barn site and columns (t) as the recapture week at the fence site. The final row (s+1) is the total number of unmarked animals captured at the fence that week, and the final column (t+1) is the total number of marked animals from the barn that week that were never recaptured."
)
```

A comparison of mark-recapture estimators include a fully pooled Lincoln-Petersen, a fully stratified model and a logically-pooled model indicated that the most parsimonious model with the lowest AICc was the logically pooled estimator (**Table 4**). The first two weeks (19, 20) and the last two weeks (25 and 26) were pooled based on their similar catch probabilities and smaller number of recaptures (full model output in available in **Appendix A**). Using this estimator, the population of wild coho smolts (>70 mm) migrating from Toboggan Creek in 2024 was `r paste0(report.table[1,"Nhat"]," +/- ",report.table[1,"Nhat.se"],"SE")`.

```{r Table 5 MR}

kable(report.table,
      col.names = c("Model","s","t","AICc","Delta AICc","gof.chisq", "gof.df", "gof.p",  "Nhat", "Nhat SE"),
        caption = "Table 5. Summary of the number of injected smolts for each coded-wire tag. Coho were generally sorted by size for coded-wire tagging. Estimated retention was based on a subsample of tagged smolts each week held for 24 hours after initial tagging.", 
        format = "pandoc",full_width=T, latex_options = "HOLD_position",bootstrap_options = c("striped", "hover")
)

```

\newpage

# Conclusion

Following the pause in hatchery smolt releases due to a disease outbreak in 2024, StAD was presented with a unique opportunity to focus on a wild smolt mark-recapture. This pilot smolt marking field program successfully met its objectives. The 2024 Toboggan Smolt Program generated a population estimate of wild smolts to be just over 35,000 with a CV under 5%. Though age sampling was unevenly sampled through the season we were able to charactierize the size distribution and age range within the population, including identifying a substantial number of smolts 3 and 4 years old that had apparently reared in the watershed for more that one season. Finally, while the Toboggan Creek Hatchery released an average of about 32,000 tagged smolts from the spring of 1987 to 2023 (data on file, DFO Smithers), there is potnetially higher survival of wild smolts which may make up for the smaller releases (Chicatun 2024). With some adjustments to future years of sampling, the program procedures piloted this year met and exceeded expectations.
 
The continuation of the wild smolt marking program will be key for evaluating assumption that wild and hatchery survival is the same in past years, which has been a key assumption of the Toboggan Creek indicator program. The information gained on wild coho smolt population can be compared in the future to other watersheds and over time to evaluate changes in freshwater habitat. Information about marine survival should available after the fall of 2025, when the majority of the smolts released in spring of 2024 should return as spawning adults (PSC Tech. Rep. No. 47). 

\newpage

# References 
Chicatun, Victoria, “Toboggan Smolt Standard Operating Procedures 2024 – DRAFT V2,” Fisheries and Oceans Canada North Coast Stock Assessment Branch. May, 2024.

Fisheries and Oceans Canada North Coast Stock Assessment Branch, “Northern British Columbia Coho Salmon Information Summary,” Pacific Salmon Comm. Tech. Rep. No. 47, 73 p, 2022.

Pacific Salmon Commission Northern Boundary Technical Committee (PSC NBTC), “STATUS OF COHO SALMON STOCKS AND FISHERIES IN THE NORTHERN BOUNDARY AREA, REPORT TCNB (02)-3,”
2002.

P. Wolf, “A trap for the capture of fish and other organisms moving downstream,” Transactions of the American Fisheries Society, vol. 80, pp. 41–45, 1951.

SKR Consultants, “Toboggan Creek Coho Smolt Enumeration 2001,” Available: https://www.gov.bc.ca/TobogganCreekCohoSmoltEnumeration2001_1519664118144_9663846798.pdf, 2001.

Environment Canada 2025. Real-Time Hydrometric Data Graph for SIMPSON CREEK AT THE MOUTH (08EE012) [BC] - Water Level and Flow - Environment Canada

\newpage

# Appendix A

Figure A1: The most parsimonious model output from SPAS (Schwarz 2025) following logical pooling of strata.
```{r SPAS model results}

SPAS::SPAS.print.model(mod3)

```


```{r Figure X-bubble plot, results = 'hide', fig.cap="Figure X. Bubble plot representation of the observed age-length key for wild coho smolts at Toboggan Creek. Age is represented by the Gilbert-rich (GR) age designation system.", echo=F, include=F}
# 
# df_co_w <- df_fish %>% 
#   filter(species == "Coho (wild)") %>% 
#   select(fork_length_mm, `GR AGE`)
# 
# df_co_w <- df_co_w %>% mutate(`GR AGE` = ifelse(`GR AGE` == "", NA, `GR AGE`))
# df_co_w <- df_co_w %>% mutate(lcat5 = lencat(fork_length_mm, w = 5))
# 
# aged <- df_co_w %>% filter(!is.na(`GR AGE`))
# unaged <- df_co_w %>% filter(is.na(`GR AGE`))
# 
# aged <- aged%>% mutate(`GR AGE` = as.numeric(`GR AGE`))
# 
# aged <- aged %>% filter(`GR AGE` %in% c(22, 33, 44))
# 
# alk.freq <- xtabs(~ lcat5 + `GR AGE`, data = aged)
# rowSums(alk.freq)
# alk <- prop.table(alk.freq, margin=1)
# 
# ggplot(aged, aes(x = fork_length_mm, y = `GR AGE`)) +
#   geom_point(
#     color = "skyblue",
#     size = 3,
#     alpha = 0.7
#   ) +
#   scale_y_continuous(
#     breaks = c(22, 33, 44),
#     labels = c("22", "33", "44"),
#     expand = expansion(mult = c(0.05, 0.05))
#   ) +
#   scale_x_continuous(
#     breaks = seq(50, 200, 25),
#     expand = expansion(mult = c(0.02, 0.02))
#   ) +
#   labs(
#     x = "Fork Length (mm)",
#     y = "Age"
#   ) +
#   theme_minimal(base_size = 12) +
#   theme(
#     panel.grid.major = element_line(color = "grey80", linewidth = 0.4),
#     panel.grid.minor = element_blank(),
#     axis.text = element_text(color = "black"),
#     axis.title = element_text(color = "black"),
#     axis.ticks = element_line(color = "black"),
#     axis.ticks.length = unit(0.2, "cm")
#   )

```

